# **Implementation of a SDR classifier.**

A classifier in machine learning is an algorithm that automatically orders or categorizes data into one or more set of “classes”. The SDR classifier takes the form of a single layer classification network that takes SDRs as input and outputs a predicted distribution of classes.The SDR Classifier accepts a binary input pattern from the level below (the "activationPattern" - the vector of Temporal Memory’s active cells) and information from the sensor and encoders (the "classification") describing the true (target) input. 

![image](https://user-images.githubusercontent.com/116737927/213930553-b17a2fa3-12fd-451c-8975-28eb94ce7ce8.png)


Fig1. SDR Classifier in relation to the other modules of an HTM Network

The SDR classifier maps input patterns to class labels. There are as many output units as the number of class labels or buckets (in the case of scalar encoders). The output is a probabilistic distribution over all class labels. During inference, the output is calculated by first doing a weighted summation of all the inputs, and then perform a softmax nonlinear function to get the predicted distribution of class labels During learning, the connection weights between input units and output units are adjusted to maximize the likelihood of the model.

**Spatial Pooler and Temporal Memory:**

The Spatial Pooler is responsible for reducing the dimensionality of input data by learning which features are most informative, while the Temporal Memory is responsible for learning temporal patterns in the data by creating sparse, distributed representations of the input. Together, these algorithms allow the HTM model to learn and make predictions based on sequences of input data.


**Methods to be implemented:**

+ compute(recordNum, patternNZ, classification, learn, infer)
  : Process one input sample
  
+ infer(patternNZ, actValueList)
  : Return the inference value from one input sample.
  
+ inferSingleStep(patternNZ, weightMatrix)
  : Perform inference for a single step. Given an SDR input and a weight matrix, return a predicted distribution.
  
+ static create(*args, **kwargs)
  : Create a SDR classifier factory. The implementation of the SDR Classifier can be specified with the “implementation” keyword argument.

**Project outline:**
1. Finding input dataset and preprocessing and converting it to the format accepted by SDR classifier as input.
2. implementing Learning function
3. implementing Inference function 
4. Unit tests
5. Training the model and  enhancing the results by trying different parameter values.


**Input of SDR:**

a set of numerical or binary values that represent the features or attributes of an object or data sample.
Example:In image classification: the input to an SDR classifier could be a set of pixel values representing an image, where each pixel value is treated as a feature. 

In text classification, the input could be a set of word frequencies or word embeddings extracted from a text document.

The input features are transformed into sparse, binary vectors that encode the presence or absence of certain features or attributes in the input. These sparse vectors are then compared to predefined representations stored in the classifier's memory to produce the output.

**Outputs of SDR:**

An SDR classifier takes in a set of inputs and produces a binary output indicating the presence or absence of a particular class or category. The output is generated by comparing the input to a set of predefined sparse distributed representations stored in the classifier's memory.

**Implementation:**

To implement an SDR classifier using the Neocortex API, you would need to perform the following steps:

1. Collect and preprocess the data you want to classify. This typically involves cleaning, transforming, and splitting the data into training and testing sets.

2. Train the SDR classifier using the Neocortex API's machine learning algorithms. You would need to specify the number of categories to be classified, the type of data, and the parameters of the algorithm.

3. Evaluate the performance of the classifier using metrics such as accuracy, precision, recall, and F1 score. You may need to adjust the parameters of the classifier and repeat the training process until you are satisfied with the performance.

4. Finally, use the trained classifier to make predictions on new, unseen data.


Example of implementing an SDR classifier using the Neocortex API in C#:

```csharp
using System;
using Neocortex;

namespace SDRClassifierExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // Step 1: Load the data
            // Assume that you have a matrix of feature vectors, where each row represents a sample and each column represents a feature
            double[][] featureVectors = LoadData();
            int numSamples = featureVectors.Length;
            int numFeatures = featureVectors[0].Length;

            // Step 2: Train the classifier
            int numClasses = 2; // Assume that there are 2 classes
            int[] labels = new int[numSamples]; // Assume that you have a vector of class labels, where each element corresponds to the label of a sample
            SDRClassifier classifier = new SDRClassifier(numClasses, numFeatures);
            classifier.Train(featureVectors, labels);

            // Step 3: Evaluate the classifier
            double accuracy = Evaluate(classifier, featureVectors, labels);
            Console.WriteLine("Accuracy: " + accuracy);

            // Step 4: Use the classifier to make predictions
            double[] newSample = new double[numFeatures]; // Assume that you have a new sample
            int prediction = classifier.Predict(newSample);
            Console.WriteLine("Prediction: " + prediction);

            Console.ReadLine();
        }

        private static double[][] LoadData()
        {
            // Load the data here
            return null;
        }

        private static double Evaluate(SDRClassifier classifier, double[][] featureVectors, int[] labels)
        {
            // Evaluate the classifier here
            return 0;
        }
    }
}
```